VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Form_QRY_VEICULOS_ALUGADOS subformulário"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub Form_DblClick(Cancel As Integer)
    Dim VLR_TOTAL As Double
    Dim CNN As ADODB.Connection
    Dim RS As New ADODB.Recordset
    
    Set CNN = CurrentProject.Connection
    RS.Open "SELECT * FROM TBL_ALUGUEL WHERE NUM_ID = " & NUM_ID, CNN, adOpenKeyset, adLockOptimistic
    
    Form_FRM_ALUGUEL.NUM_ID_VEICULO.RowSource = "SELECT TBL_VEICULOS.NUM_ID, TBL_VEICULOS.STR_MARCA, TBL_VEICULOS.STR_PLACA FROM TBL_VEICULOS LEFT JOIN TBL_ALUGUEL ON TBL_VEICULOS.NUM_ID = TBL_ALUGUEL.NUM_ID_VEICULO WHERE TBL_ALUGUEL.NUM_ID_VEICULO = " & RS!NUM_ID_VEICULO
    Form_FRM_ALUGUEL.NUM_ID_VEICULO = RS!NUM_ID_VEICULO
    Form_FRM_ALUGUEL.NUM_ID_VEICULO.Requery
    Form_FRM_ALUGUEL.NUM_ID_FUNCIONARIO.RowSource = "SELECT TBL_FUNCIONARIO.NUM_ID, TBL_FUNCIONARIO.STR_NOME, TBL_FUNCIONARIO.STR_AREA FROM TBL_FUNCIONARIO LEFT JOIN TBL_ALUGUEL ON TBL_FUNCIONARIO.NUM_ID = TBL_ALUGUEL.NUM_ID_FUNCIONARIO WHERE TBL_ALUGUEL.NUM_ID_FUNCIONARIO = " & RS!NUM_ID_FUNCIONARIO
    Form_FRM_ALUGUEL.NUM_ID_FUNCIONARIO = RS!NUM_ID_FUNCIONARIO
    Form_FRM_ALUGUEL.NUM_ID_FUNCIONARIO.Requery
    Form_FRM_ALUGUEL.DT_CHECK_IN = RS!DT_CHECK_IN
    Form_FRM_ALUGUEL.NUM_ID = NUM_ID
    
    Form_FRM_ALUGUEL.NUM_ID_VEICULO.Enabled = False
    Form_FRM_ALUGUEL.NUM_ID_FUNCIONARIO.Enabled = False
    Form_FRM_ALUGUEL.DT_CHECK_IN.Enabled = False
    Form_FRM_ALUGUEL.DT_CHECK_OUT.Enabled = False
    Form_FRM_ALUGUEL.VLR_TOTAL.Enabled = False
    
    Form_FRM_ALUGUEL.DT_CHECK_OUT = Date
    
    VLR_TOTAL = DateDiff("D", RS!DT_CHECK_IN, Date) * DLookup("VLR_DIARIA", "TBL_VEICULOS", "NUM_ID=" & RS!NUM_ID_VEICULO)
    
    Form_FRM_ALUGUEL.VLR_TOTAL = VLR_TOTAL
    
    
End Sub
